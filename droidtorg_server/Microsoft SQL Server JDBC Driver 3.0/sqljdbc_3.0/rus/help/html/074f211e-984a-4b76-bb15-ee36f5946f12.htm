<html DIR="LTR" xmlns:tool="http://www.microsoft.com/tooltip" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
  <head>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=utf-8" />
    <META NAME="save" CONTENT="history" />
    <title>Новые возможности драйвера JDBC</title>
    
    <link rel="stylesheet" type="text/css" href="../local/Classic.css">
      
    </link>
    
    <script src="../local/script.js">
      
    </script><script src="../local/script_main.js">&amp;nbsp;</script>
  </head>
  <body>
    <!--Topic built:04/01/2010 05:03:29-->

    
    
    
    
    
    
    
    
    
    <div id="header">
      <table width="100%" id="topTable"><tr>
          <td align="left">
            <span id="headerBold">Новые возможности драйвера JDBC</span>
          </td>
          <td align="right">
            
          </td>
        </tr></table>
      
      
      
    </div>
    <div id="mainSection">
      
        
        
    <font color="DarkGray">
      
    </font>
    <p />
    
    <p />
  
        <div id="introductionSection" class="section">
    <p>В следующих разделах описываются новые функции драйвера Microsoft SQL Server JDBC.</p>
  </div><h1 class="heading">Новые возможности драйвера JDBC версии 3.0</h1><div id="sectionSection0" class="section"><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
      <p xmlns="">
        В версии 3.0 драйвера Microsoft SQL Server JDBC реализовано несколько новых функций и усовершенствований.</p>
    </content><sections xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
      <h1 class="heading" xmlns="">Имя драйвера</h1><div id="sectionSection" class="section" xmlns=""><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
          <p xmlns="">Новая версия драйвера JDBC называется Microsoft SQL Server JDBC 3.0.</p>
        </content></div>
      <h1 class="heading" xmlns="">Поддержка типов данных даты и времени SQL Server 2008, добавленных в SQL Server 2008</h1><div id="sectionSection" class="section" xmlns=""><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
          <p xmlns="">Драйвер Microsoft SQL Server JDBC 3.0 теперь поддерживает следующие типы данных SQL Server.</p>
          <ul xmlns=""><li>
              
                <b>time</b>
              <br />
            </li><li>
              
                <b>date</b>
              <br />
            </li><li>
              
                <b>datetime2</b>
              <br />
            </li><li>
              
                <b>datetimeoffset</b>
              <br />
            </li></ul>
          <p xmlns="">Дополнительные сведения об этих типах данных SQL Server см. в разделе <a href="http://go.microsoft.com/fwlink/?LinkId=183664" target="_blank" alt=""><linkText xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">Типы данных и функции даты и времени (Transact-SQL)</linkText></a>.</p>
          <p xmlns="">Добавлен тип <a href="20bbeacd-ccca-4a46-8184-ff941ae2ec5f.htm">Класс DateTimeOffset</a>, а также функции для доступа к значениям в столбце <b>datetimeoffset</b>:</p>
          <ul xmlns=""><li>
              
                <a href="7d9d7b05-582a-41df-b2c4-ec4a64d49752.htm">SQLServerCallableStatement.getDateTimeOffset</a>
              <br />
            </li><li>
              
                <a href="9383e14d-c83e-43c5-980c-50a3e0bedc31.htm">SQLServerCallableStatement.setDateTimeOffset</a>
              <br />
            </li><li>
              
                <a href="5014dba9-1755-4769-b070-6cbeecee864e.htm">SQLServerPreparedStatement.setDateTimeOffset</a>
              <br />
            </li><li>
              
                <a href="60ec0499-1c2a-4476-9e32-03b9d698fe54.htm">SQLServerResultSet.getDateTimeOffset</a>
              <br />
            </li><li>
              
                <a href="40d7fced-cce1-4534-b794-71bc735e53e0.htm">SQLServerResultSet.updateDateTimeOffset</a>
              <br />
            </li></ul>
        </content></div>
      <h1 class="heading" xmlns="">Настройка способа отправки значений java.sql.Time на сервер</h1><div id="sectionSection" class="section" xmlns=""><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
          <p xmlns="">Добавлено свойство соединения <b>sendTimeAsDatetime</b>. <b>sendTimeAsDatetime</b> определяет порядок отправки значения java.sql.Time на сервер — в виде значения SQL Server <b>time</b> или <b>datetime</b>.</p>
          <p xmlns="">Сведения об использовании свойства соединения <b>sendTimeAsDatetime</b> см. в разделе <a href="f1b62700-f046-488d-bd6b-a5cd8fc345b7.htm">Задание свойств соединения</a>.</p>
          <p xmlns="">Дополнительные сведения об отправке типов java.sql.Time на сервер см. в разделе <a href="07eb00dd-621a-46f9-a5a5-8cab4d6058b5.htm">Настройка способа отправки значений java.sql.Time на сервер</a>.</p>
          <p xmlns="">Значение свойства соединения <b>sendTimeAsDatetime</b> можно изменить программным образом с помощью <a href="705a0494-b5e2-43db-940a-1b8cec550cdb.htm">SQLServerDataSource.setSendTimeAsDatetime</a>.</p>
        </content></div>
      <h1 class="heading" xmlns="">Полная поддержка операций MERGE</h1><div id="sectionSection" class="section" xmlns=""><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
          <p xmlns="">Следующие методы теперь возвращают правильное количество строк для операции MERGE:</p>
          <ul xmlns=""><li>
              
                <a href="10ae662a-ce3c-4b24-875c-5c2df319d93b.htm">SQLServerStatement.executeUpdate</a>
              <br />
            </li><li>
              
                <a href="e9570228-4500-44b6-b2f1-84ac050b5112.htm">SQLServerStatement.getUpdateCount</a>
              <br />
            </li><li>
              
                <a href="677b0907-316e-40f2-a0d9-d4d0872c7f52.htm">SQLServerPreparedStatement.executeUpdate</a>
              <br />
            </li><li>
              SQLServerPreparedStatement.getUpdateCount (наследуется от SQLServerStatement)<br />
            </li><li>
              SQLServerCallableStatement.executeUpdate (наследуется от SQLServerPreparedStatement)<br />
            </li><li>
              SQLServerPreparedStatement.getUpdateCount (наследуется от SQLServerStatement)<br />
            </li></ul>
        </content></div>
      <h1 class="heading" xmlns="">Методы getBytes, setBytes и updateBytes не поддерживаются с типами даты и времени</h1><div id="sectionSection" class="section" xmlns=""><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
          <p xmlns="">В версии 2.0 драйвера Microsoft SQL Server JDBC можно использовать методы <a href="b6e88cea-54b3-4d18-a9af-db54abf19f45.htm">SQLServerCallableStatement.getBytes</a>, <a href="f264f1a6-ee35-4eaf-81d8-ecf99f03b35d.htm">SQLServerCallableStatement.setBytes</a>, <a href="d16a0aea-6144-4fcb-bcbc-5d7daa36d327.htm">SQLServerResultSet.getBytes</a> и <a href="3050c836-fbb3-4475-99e5-05637a48a932.htm">SQLServerResultSet.updateBytes</a> для преобразования значений между массивами байтов и типами данных SQL Server <b>date</b>, <b>time</b>, <b>datetime2</b> и<b> datetimeoffset</b>. В версии 3.0 драйвера SQL Server JDBC при использовании этих методов с такими типами данных вызывается исключение, указывающее, что преобразование не поддерживается.</p>
        </content></div>
      <h1 class="heading" xmlns="">Метод getObject возвращает объект даты или времени</h1><div id="sectionSection" class="section" xmlns=""><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
          <p xmlns="">В версии 2.0 драйвера Microsoft SQL Server JDBC при использовании метода <a href="c5cc562f-2c5a-4fdb-a552-dfb08c2bf0ad.htm">SQLServerCallableStatement.getObject</a> или <a href="924df406-14b2-40b8-a7bc-c2fd145d7d7c.htm">SQLServerResultSet.getObject</a> для получения значения типа date, time, datetime2 или datetimeoffset возвращается объект типа java.lang.String.</p>
          <p xmlns="">В версии 3.0 драйвера SQL Server JDBC действуют следующие правила.</p>
          <ul xmlns=""><li>
              Значение типа date будет возвращаться в виде объекта java.sql.Date.<br />
            </li><li>
              Значение типа time будет возвращаться в виде объекта java.sql.Time.<br />
            </li><li>
              Значение типа datetime2 будет возвращаться в виде объекта java.sql.Timestamp.<br />
            </li><li>
              Значение типа datetimeoffset будет возвращаться в виде объекта microsoft.sql.DateTimeOffset.<br />
            </li></ul>
        </content></div>
      <h1 class="heading" xmlns="">Изменение в поведении столбцов</h1><div id="sectionSection" class="section" xmlns=""><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
          <p xmlns="">В версии 3.0 драйвера SQL Server JDBC для некоторых столбцов метод SQLServerDatabaseMetaData.getColumns возвращает значения, отличающиеся от значений, возвращаемых в предыдущих версиях драйвера. Дополнительные сведения см. в разделе <a href="f173fa5d-e114-4a37-a5c4-2baad9ff3af1.htm">SQLServerDatabaseMetaData.getColumns</a>.</p>
          <p xmlns="">Также изменено поведение следующих методов в SQLServerResultSetMetaData:</p>
          <ul xmlns=""><li>
              
                <a href="21c25443-bd2b-4b60-9798-4efe2c158952.htm">SQLServerResultSetMetaData.getColumnDisplaySize</a>
              <br />
            </li><li>
              
                <a href="81815a41-9265-4574-a4d8-f6341a68d9fd.htm">SQLServerResultSetMetaData.getColumnType</a>
              <br />
            </li><li>
              
                <a href="a444da82-c1af-40a5-9774-02476416c92c.htm">SQLServerResultSetMetaData.getColumnTypeName</a>
              <br />
            </li><li>
              
                <a href="fe29aa5f-4cc5-413f-8bbd-a58064993d87.htm">SQLServerResultSetMetaData.getScale</a>
              <br />
            </li></ul>
        </content></div>
      <h1 class="heading" xmlns="">Интерфейсы</h1><div id="sectionSection" class="section" xmlns=""><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
          <p xmlns="">Добавлены следующие интерфейсы:</p>
          <ul xmlns=""><li>
              
                <a href="030a1631-cfcd-41e0-beb5-47f93c01e8e0.htm">ISQLServerCallableStatement</a>
              <br />
            </li><li>
              
                <a href="031c01e2-2c65-4fe4-9700-fdbcc7a39f30.htm">ISQLServerConnection</a>
              <br />
            </li><li>
              
                <a href="ba1d3242-19ca-4321-83fe-867a4f69f1d4.htm">ISQLServerDataSource</a>
              <br />
            </li><li>
              
                <a href="cf87892e-5c34-4ac6-8258-c2a81e117b26.htm">ISQLServerPreparedStatement</a>
              <br />
            </li><li>
              
                <a href="002496f7-8ec0-4267-b4e6-ba095e2ef306.htm">ISQLServerResultSet</a>
              <br />
            </li><li>
              
                <a href="7f83b514-6e76-4f37-baf3-a10db2010e7c.htm">ISQLServerStatement</a>
              <br />
            </li></ul>
          <p xmlns="">Дополнительные сведения см. в разделе <a href="27fc9b72-9f21-4728-abcb-5c015f28a6ab.htm">Оболочки и интерфейсы</a>.</p>
        </content></div>
      <h1 class="heading" xmlns="">Планируется устаревание конструкторов классов</h1><div id="sectionSection" class="section" xmlns=""><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
          <p xmlns="">В версии 3.0 драйвера JDBC для SQL Server корпорация Майкрософт заявляет, что в следующей версии конструкторы нескольких классов станут устаревшими, поскольку корпорация Майкрософт не рекомендует разработчикам напрямую создавать экземпляры этих типов.</p>
          <p xmlns="">Конструкторы для этих классов не являются устаревшими в версии 3.0 драйвера JDBC для SQL Server.</p>
          <p xmlns="">В версии 3.0 драйвера JDBC для SQL Server следующие классы имеют соответствующие интерфейсы. Для доступа к методу или константе, определяемой драйвером, необходимо использовать интерфейс, а не класс:</p>
          <ul xmlns=""><li>
              
                <a href="30710a63-c05d-47d9-9cf9-c087a1c76373.htm">Класс SQLServerCallableStatement</a> (соответствующий интерфейс — <a href="030a1631-cfcd-41e0-beb5-47f93c01e8e0.htm">Интерфейс ISQLServerCallableStatement</a>)<br />
            </li><li>
              
                <a href="937292a6-1525-423e-a2b2-a18fd34c2893.htm">Класс SQLServerConnection</a> (соответствующий интерфейс — <a href="031c01e2-2c65-4fe4-9700-fdbcc7a39f30.htm">Интерфейс ISQLServerConnection</a>)<br />
            </li><li>
              
                <a href="a8481c06-fbba-432b-8c69-4f4619c20ad4.htm">Класс SQLServerPreparedStatement</a> (соответствующий интерфейс — <a href="cf87892e-5c34-4ac6-8258-c2a81e117b26.htm">Интерфейс ISQLServerPreparedStatement</a>)<br />
            </li><li>
              
                <a href="eaffcff1-286c-459f-83da-3150778480c9.htm">Класс SQLServerResultSet</a> (соответствующий интерфейс — <a href="002496f7-8ec0-4267-b4e6-ba095e2ef306.htm">Интерфейс ISQLServerResultSet</a>)<br />
            </li><li>
              
                <a href="ec24963c-8b51-4838-91e9-1fbfa2347451.htm">Класс SQLServerStatement</a> (соответствующий интерфейс — <a href="7f83b514-6e76-4f37-baf3-a10db2010e7c.htm">Интерфейс ISQLServerStatement</a>)<br />
            </li></ul>
          <p xmlns="">Конструкторы следующих классов устареют в следующей версии и не имеют соответствующих интерфейсов, поскольку данные классы не предоставляют функций, необходимых SQL Server:</p>
          <ul xmlns=""><li>
              
                <a href="8b8049d0-8c6d-4476-866b-098709f37eec.htm">SQLServerDatabaseMetaData</a>
              <br />
            </li><li>
              
                <a href="af5ef257-7cf6-4db3-b1ee-07d22d82bef1.htm">SQLServerException</a>
              <br />
            </li><li>
              
                <a href="546290e0-9411-4a2b-aa36-61251e70e9cf.htm">SQLServerParameterMetaData</a>
              <br />
            </li><li>
              
                <a href="4c87e9d3-904a-4b86-90cc-3684034c86ee.htm">SQLServerPooledConnection</a>
              <br />
            </li><li>
              
                <a href="9a36885f-83f3-44af-85f0-2b849dfd20d4.htm">SQLServerResultSetMetaData</a>
              <br />
            </li><li>
              
                <a href="1ae7db7b-959f-4142-8d9f-aa427869c6ac.htm">SQLServerSavepoint</a>
              <br />
            </li><li>
              
                <a href="5ecb4bf1-b8d1-47cf-9cb1-7a18acc11ce2.htm">SQLServerXAConnection</a>
              <br />
            </li></ul>
        </content></div>
      <h1 class="heading" xmlns="">Метод SQLServerDataSource.getReference больше не содержит пароль или trustStorePassword</h1><div id="sectionSection" class="section" xmlns=""><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
          <p xmlns="">В версиях драйвера JDBC, предшествующих версии 3.0, если метод <a href="0db06631-5e68-488c-a9f1-6e5052c0759d.htm">SQLServerDataSource.setPassword</a> вызывался в объекте <b>SQLServerDataSource</b>, пароль присутствовал в объекте, возвращаемом <a href="b3fb1a97-86ee-4977-adca-c35ae199dbb3.htm">SQLServerDataSource.getReference</a>, что позволяло использовать объект для создания дополнительных соединений. В версии 3.0 драйвера JDBC пароль для объекта, возвращаемого методом <b>SQLServerDataSource.getReference</b>, необходимо установить перед установлением соединения с объектом.</p>
          <p xmlns="">Кроме того, если <a href="fa87cbde-71cc-4f21-bc07-f8ba2b6a0a3f.htm">SQLServerDataSource.setTrustStorePassword</a> задается перед привязкой свойств источника данных, необходимо вызвать метод <b>SQLServerDataSource.setTrustStorePassword</b> перед получением соединения. Дополнительные сведения см. в разделе <b>SQLServerDataSource.getReference</b>.</p>
        </content></div>
      <h1 class="heading" xmlns="">Поддержка разреженных столбцов</h1><div id="sectionSection" class="section" xmlns=""><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
          <p xmlns="">Драйвер SQL Server JDBC версии 3.0 поддерживает разреженные столбцы при подключении к серверу SQL Server 2008 или более поздней версии. Дополнительные сведения см. в разделе <a href="7d4237e0-818f-4639-9093-d5ac9683fc71.htm">Разреженные столбцы</a>.</p>
        </content></div>
      <h1 class="heading" xmlns="">Определяемые пользователем типы больших значений</h1><div id="sectionSection" class="section" xmlns=""><content xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">
          <p xmlns="">Добавлена поддержка определяемых пользователем типов крупнее 8 килобайт. Дополнительные сведения см. в разделе <a href="19a71b27-b788-43a3-a76d-fe3001a6f016.htm">Определяемые пользователем типы</a>.</p>
        </content></div>
    </sections></div><span id="seeAlsoSpan"><h1 class="heading">См. также</h1></span><div id="seeAlsoSection" class="section" name="collapseableSection"><a href="939a8773-2583-49a4-bf00-6b892fbe39dc.htm">Общие сведения о драйвере JDBC</a><br /><br /></div><!--[if gte IE 5]>
			<tool:tip element="seeAlsoToolTip" avoidmouse="false"/><tool:tip element="languageFilterToolTip" avoidmouse="false"/><tool:tip element="roleInfoSpan" avoidmouse="false"/>
		<![endif]-->
      <div id="footer" class="section">
        
		<hr />
		
		<span id="fb" class="feedbackcss">
			
			
		</span>
		
		<a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">
			
			© Корпорация Майкрософт (Microsoft Corporation), 2010. Все права защищены.
		</a>
 	
	
      </div>
    </div>
  </body>
</html>